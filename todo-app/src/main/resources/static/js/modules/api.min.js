const TASKS_URL="/api/tasks",SWIMLANES_URL="/api/swimlanes",SSE_URL="/api/sse/stream";"undefined"!=typeof axios?(axios.interceptors.request.use(e=>(console.log(`[API] >>> REQUEST: ${e.method.toUpperCase()} ${e.url}`),e.data&&console.log("[API] >>> Payload:",e.data),e.params&&console.log("[API] >>> Params:",e.params),e)),axios.interceptors.response.use(e=>(console.log(`[API] <<< RESPONSE: ${e.config.method.toUpperCase()} ${e.config.url} - Status: ${e.status}`),console.log("[API] <<< Data:",e.data),e),e=>(console.error("[API] <<< ERROR:",{url:e.config?.url,method:e.config?.method,status:e.response?.status,message:e.message,data:e.response?.data}),Promise.reject(e)))):console.error("[API] FATAL: Axios is not loaded! API calls will fail.");export const Api={async fetchTasks(){console.log("[API] fetchTasks() - Fetching all tasks");const e=await axios.get(TASKS_URL);return console.log(`[API] fetchTasks() - Returned ${e.data.length} tasks`),e.data},async fetchTasksByLane(e){console.log(`[API] fetchTasksByLane() - Params: { swimLaneId: ${e} }`);const a=await axios.get(`${TASKS_URL}/swimlane/${e}`);return console.log(`[API] fetchTasksByLane(${e}) - Returned ${a.data.length} tasks`),a.data},async createTask(e){console.log("[API] createTask() - Params:",e);const a=await axios.post(TASKS_URL,e);return console.log("[API] createTask() - Created task:",a.data),a.data},async updateTask(e,a){console.log(`[API] updateTask() - Params: { id: ${e}, data:`,a,"}");const s=await axios.put(`${TASKS_URL}/${e}`,a);return console.log("[API] updateTask() - Updated task:",s.data),s.data},async moveTask(e,a,s,o){console.log("[API] moveTask() - Params:",{id:e,status:a,swimLaneId:s,position:o});let t=`${TASKS_URL}/${e}/move?status=${a}&swimLaneId=${s}`;null!=o&&(t+=`&position=${o}`),console.log(`[API] moveTask() - Full URL: ${t}`);const n=await axios.patch(t);return console.log("[API] moveTask() - Response:",n.data),n.data},async deleteTask(e){console.log(`[API] deleteTask() - Params: { id: ${e} }`),await axios.delete(`${TASKS_URL}/${e}`),console.log(`[API] deleteTask(${e}) - Deleted successfully`)},async addComment(e,a){console.log("[API] addComment() - Params:",{taskId:e,text:a});const s=await axios.post(`${TASKS_URL}/${e}/comments`,a,{headers:{"Content-Type":"text/plain"}});return console.log("[API] addComment() - Response:",s.data),s.data},async fetchSwimLanes(){console.log("[API] fetchSwimLanes() - Fetching active swimlanes");const e=await axios.get(`${SWIMLANES_URL}/active`);return console.log(`[API] fetchSwimLanes() - Returned ${e.data.length} lanes`),e.data},async fetchCompletedSwimLanes(){console.log("[API] fetchCompletedSwimLanes() - Fetching completed swimlanes");const e=await axios.get(`${SWIMLANES_URL}/completed`);return console.log(`[API] fetchCompletedSwimLanes() - Returned ${e.data.length} lanes`),e.data},async createSwimLane(e){console.log(`[API] createSwimLane() - Params: { name: "${e}" }`);const a=await axios.post(SWIMLANES_URL,{name:e});return console.log("[API] createSwimLane() - Created lane:",a.data),a.data},async reorderSwimlanes(e){console.log("[API] reorderSwimlanes() - Params:",{orderedIds:e}),await axios.patch(`${SWIMLANES_URL}/reorder`,e),console.log("[API] reorderSwimlanes() - Reorder successful")},async completeSwimLane(e){console.log(`[API] completeSwimLane() - Params: { id: ${e} }`);const a=await axios.patch(`${SWIMLANES_URL}/${e}/complete`);return console.log("[API] completeSwimLane() - Response:",a.data),a.data},async deleteSwimLane(e){console.log(`[API] deleteSwimLane() - Params: { id: ${e} }`),await axios.delete(`${SWIMLANES_URL}/${e}`),console.log(`[API] deleteSwimLane(${e}) - Deleted successfully`)},initSSE(e,a,s){console.log("[SSE] Initializing connection to",SSE_URL);const o=new EventSource(SSE_URL);return o.onopen=()=>{console.log("[SSE] Connection established")},o.addEventListener("task-updated",a=>{const s=JSON.parse(a.data);console.log("[SSE] Event: task-updated",s),e(s)}),o.addEventListener("task-deleted",e=>{const s=JSON.parse(e.data);console.log("[SSE] Event: task-deleted",{taskId:s}),a(s)}),o.addEventListener("lane-updated",e=>{const a=JSON.parse(e.data);console.log("[SSE] Event: lane-updated",a),s(a)}),o.onerror=t=>{console.error("[SSE] Connection error, will reconnect in 5s...",t),o.close(),setTimeout(()=>this.initSSE(e,a,s),5e3)},o}};